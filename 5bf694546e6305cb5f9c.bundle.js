(self.webpackChunkmultiple_choice_quiz=self.webpackChunkmultiple_choice_quiz||[]).push([[115],{172:function(e){e.exports='<input type="checkbox" class="answer-checkbox__input"> <label class="answer-checkbox__label"></label> <span class="answer-reveal"></span>'},851:function(e){e.exports='<progress id="loading"></progress> <div id="decryptFailed" style="display:none"> Decryption failed! </div> <div id="saveError" style="display:none"> Error saving the results! </div> <div class="key" id="need-key" style="display:none"> <h1>This quiz is encrypted</h1> <p>Please enter the decryption key.</p> <label for="key">Decryption key</label> <input id="key"> <button id="decrypt">OK</button> </div> <div id="saving" style="visibility:hidden"> Your results are being saved, do not close the app. </div> <div class="question"> <h1 id="question"></h1> <p> This question <span id="percent"></span> was asked <span id="total"></span>. </p> </div> <form class="answers"> </form> <div class="controls"> <button id="save" title="save the answers">save answers</button> <button id="next" title="see the next question">see next question</button> <span id="done" style="display:none">Congratulations you are done!</span> </div>'},115:function(e,t,s){"use strict";function i(e){let t,s=/\$(.+?)\$/g;do{t=s.exec(e),t&&(e=e.substr(0,t.index)+t[1].replace(/_([^\{])/g,"<sub>$1</sub>").replace(/_\{(\S+?)\}/g,"<sub>$1</sub>").replace(/\^([^\{])/g,"<sup>$1</sup>").replace(/\^\{(\S+?)\}/g,"<sup>$1</sup>")+e.substr(t.index+t[0].length))}while(t);return e}s.r(t),s.d(t,{Quiz:function(){return d}});class n{constructor(e,t,s){this.listElement=e,this.keySelector=t,this.createElement=s,this.keyToElement=new Map,this.elementToKey=new WeakMap}update(e,t){let s=new Map,i=e=>s.get(e)||(()=>{let t=this.keySelector(e);return s.set(e,t),t})();for(let s of Array.from(this.listElement.children)){let n=s,r=e.find((e=>this.elementToKey.get(n)==i(e)));r?t(n,r):this.listElement.removeChild(n)}let n=null,r=new Map;for(let s of e){let e=i(s),l=this.keyToElement.get(e);l||(l=this.createElement(s),t(l,s),this.elementToKey.set(l,e)),r.set(e,l),null==n&&l!=this.listElement.firstElementChild?this.listElement.prepend(l):null!=n&&n.nextElementSibling!=l&&n.insertAdjacentElement("afterend",l),n=l}this.keyToElement=r}}var r=s(172),l=s.n(r);class a extends HTMLElement{constructor(){super(),this.innerHTML=l(),this.input=this.querySelector("input"),this.label=this.querySelector("label"),this.reveal=this.querySelector(".answer-reveal")}reset(){this.input.checked=!1}connectedCallback(){}disconnectedCallback(){}setData(e,t,s){this.label.setAttribute("for",this.input.id=`answer-${e}`),this.label.innerHTML=i(t.text),this.input.name=""+e,this.input.disabled=s,s?this.classList.add("reveal"):this.classList.remove("reveal"),["correct","wrong"].forEach((e=>{this.label.classList.remove(e),this.reveal.classList.remove(e)})),t.correct?(this.reveal.title="this is a correct answer",this.reveal.classList.add("correct"),this.label.classList.add("correct")):(this.reveal.title="this is a wrong answer",this.reveal.classList.add("wrong"),this.label.classList.add("wrong"))}}customElements.define("answer-checkbox",a);var o=s(851),c=s.n(o);class d extends HTMLElement{constructor(){super(),this.innerHTML=c(),this.loading=this.querySelector("#loading"),this.form=this.querySelector("form"),this.answerRenderer=new n(this.form,(e=>e[0]),(()=>new a)),this.encryptionKeyForm=this.querySelector("#need-key"),this.keyInput=this.querySelector("#key"),this.decryptBtn=this.querySelector("#decrypt"),this.decryptFailed=this.querySelector("#decryptFailed"),this.nextBtn=this.querySelector("#next"),this.saveBtn=this.querySelector("#save"),this.doneText=this.querySelector("#done"),this.saveError=this.querySelector("#saveError"),this.saving=this.querySelector("#saving"),this.total=this.querySelector("#total"),this.percent=this.querySelector("#percent"),this.questionSurface=this.querySelector(".question"),this.decryptBtn.addEventListener("click",(e=>{this.worker.postMessage({type:"load",access_token:this.access_token,spreadsheetId:this.spreadsheetId,quizfile:this.quizfile,decryptionKey:this.keyInput.value})})),this.nextBtn.addEventListener("click",(()=>{this.worker.postMessage({type:"next"})})),this.saveBtn.addEventListener("click",(()=>{let e=new FormData(this.form);this.worker.postMessage({type:"save",userAnswers:this.question.answers.map(((t,s)=>"on"==e.get(""+s)))})}))}connectedCallback(){this.questionText=this.querySelector("#question")}disconnectedCallback(){}async initialize(e,t,n,r){this.access_token=e,this.spreadsheetId=t,this.quizfile=n,this.worker=new Worker(new URL(s.p+s.u(932),s.b)),this.worker.addEventListener("message",(e=>{let t=e.data;t.question&&(this.questionText.innerHTML=i(t.question.text),this.answerRenderer.update(t.question.answers.map(((e,t)=>[t,e])),((e,s)=>{e.setData(s[0],s[1],t.reveal),this.question&&this.question.id==t.question.id||e.reset()})),this.total.innerText=`${t.question.total} ${1==t.question.total?"time":"times"}`,this.percent.innerText=0==t.question.total?"":`was answered ${Math.round(t.question.correct/t.question.total*100)}% correctly and`,this.question=t.question),this.loading.style.display=t.loading?"block":"none",this.questionSurface.style.display=t.question?"block":"none",this.encryptionKeyForm.style.display=t.needKey?"block":"none",this.decryptFailed.style.display=t.decryptFailed?"block":"none",this.nextBtn.style.display=t.question&&t.reveal&&!t.done?"inline":"none",this.saveBtn.style.display=t.question&&!t.reveal?"inline":"none",this.doneText.style.display=t.reveal&&t.done?"inline":"none",this.saving.style.visibility=t.unsaved?"visible":"hidden",this.saveError.style.display=t.saveerror?"block":"none"})),this.worker.postMessage({type:"load",access_token:e,spreadsheetId:t,quizfile:n,quizSettings:r})}}customElements.define("app-quiz",d)}}]);
//# sourceMappingURL=5bf694546e6305cb5f9c.bundle.js.map